<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>◊©◊ë◊¢◊™ ◊î◊û◊ô◊†◊ô◊ù ◊†◊ô◊†◊í'◊î</title>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üåæ</text></svg>">
    <link rel="apple-touch-icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üåæ</text></svg>">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Arial', sans-serif;
            background: linear-gradient(135deg, #87CEEB, #98FB98);
            height: 100vh;
            overflow: hidden;
            touch-action: none;
            margin: 0;
            padding: 0;
            position: fixed;
            width: 100%;
            cursor: crosshair;
        }

        body.slicing {
            cursor: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 32 32"><path d="M2 30 L30 2 L28 0 L0 28 Z" fill="%23FFD700" stroke="%23B8860B" stroke-width="2"/><circle cx="30" cy="2" r="2" fill="%23C0C0C0"/></svg>'), crosshair !important;
        }

        .game-container {
            width: 100%;
            height: 100vh;
            position: relative;
            overflow: hidden;
        }

        .intro-screen, .level-intro-screen, .game-screen {
            position: absolute;
            width: 100%;
            height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: flex-start;
            background: linear-gradient(135deg, #FFE4B5, #F0E68C);
            padding: 20px 0;
            box-sizing: border-box;
            overflow-y: auto;
            overflow-x: hidden;
        }

        .intro-screen h1, .level-intro-screen h1 {
            font-size: 2.2rem;
            color: #8B4513;
            margin: 10px 0 20px 0;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
            text-align: center;
        }

        .intro-screen p {
            text-align: center;
            margin: 5px 20px;
            line-height: 1.3;
        }

        .fruits-grid {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 15px;
            max-width: 800px;
            margin: 20px;
            width: 90%;
        }

        .fruit-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 10px;
            background: rgba(255,255,255,0.8);
            border-radius: 15px;
            cursor: pointer;
            transition: all 0.3s ease;
            user-select: none;
            min-height: 100px;
            position: relative;
            border: 2px solid transparent;
        }

        .fruit-item:hover {
            transform: scale(1.05);
        }

        .fruit-item.clicked {
            background: rgba(144,238,144,0.9);
            border: 2px solid #32CD32;
            transform: scale(1.02);
        }

        .check-mark {
            position: absolute;
            top: 5px;
            right: 5px;
            background: #32CD32;
            color: white;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.8rem;
            font-weight: bold;
        }

        .fruit-emoji {
            font-size: 3rem !important;
            margin-bottom: 5px !important;
            width: 64px !important;
            height: 64px !important;
            display: flex !important;
            align-items: center !important;
            justify-content: center !important;
        }

        .fruit-emoji img {
            width: 64px !important;
            height: 64px !important;
            object-fit: contain !important;
        }

        .target-fruit .fruit-emoji {
            width: 48px;
            height: 48px;
            object-fit: contain;
        }

        .falling-fruit {
            position: absolute;
            font-size: 4rem;
            cursor: crosshair;
            user-select: none;
            transition: transform 0.1s;
            z-index: 50;
            pointer-events: auto;
            width: 80px;
            height: 80px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .falling-fruit img {
            width: 80px;
            height: 80px;
            object-fit: contain;
        }

        .falling-fruit:active {
            transform: scale(1.2);
        }

        .fruit-name {
            font-size: 1.2rem;
            font-weight: bold;
            color: #8B4513;
        }

        .start-button, .continue-button {
            padding: 12px 25px;
            font-size: 1.3rem;
            background: #FF6B6B;
            color: white;
            border: none;
            border-radius: 25px;
            cursor: pointer;
            margin: 20px 20px 40px 20px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.3);
            transition: all 0.3s ease;
            opacity: 0.6;
            width: auto;
            max-width: 90%;
            text-align: center;
        }

        .start-button:hover, .continue-button:hover {
            transform: scale(1.05);
        }

        .start-button.ready {
            background: #32CD32;
            opacity: 1;
            animation: pulse 2s infinite;
        }

        .difficulty-selector {
            margin: 20px 0;
            text-align: center;
        }

        .difficulty-buttons {
            display: flex;
            gap: 15px;
            justify-content: center;
            flex-wrap: wrap;
            margin: 15px 0;
        }

        .difficulty-btn {
            padding: 15px 20px;
            border: 3px solid #ccc;
            border-radius: 15px;
            background: rgba(255,255,255,0.9);
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 1.1rem;
            font-weight: bold;
            color: #8B4513;
            text-align: center;
            min-width: 100px;
        }

        .difficulty-btn span {
            display: block;
            font-size: 0.8rem;
            margin-top: 5px;
            color: #666;
        }

        .difficulty-btn:hover {
            transform: scale(1.05);
        }

        .difficulty-btn.selected {
            border-color: #32CD32;
            background: rgba(50,205,50,0.2);
            transform: scale(1.1);
        }

        .difficulty-btn[data-difficulty="1"].selected {
            border-color: #32CD32;
            background: rgba(50,205,50,0.2);
        }

        .difficulty-btn[data-difficulty="2"].selected {
            border-color: #FFA500;
            background: rgba(255,165,0,0.2);
        }

        .difficulty-btn[data-difficulty="3"].selected {
            border-color: #FF4500;
            background: rgba(255,69,0,0.2);
        }

        .game-screen {
            background: linear-gradient(135deg, #87CEEB, #98FB98);
            overflow: hidden;
            justify-content: flex-start;
            padding: 0;
        }

        .game-header {
            position: absolute;
            top: 10px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(255,255,255,0.95);
            padding: 8px 15px;
            border-radius: 15px;
            text-align: center;
            z-index: 100;
            max-width: 90%;
            box-shadow: 0 2px 8px rgba(0,0,0,0.2);
        }

        .level-title {
            font-size: 1.1rem;
            color: #8B4513;
            margin-bottom: 5px;
            font-weight: bold;
        }

        .target-fruits {
            display: flex;
            gap: 8px;
            justify-content: center;
            margin-bottom: 5px;
        }

        .target-fruit {
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .target-fruit .fruit-emoji {
            font-size: 1.3rem;
        }

        .target-fruit .fruit-name {
            font-size: 0.7rem;
        }

        .game-stats {
            display: flex;
            gap: 10px;
            font-size: 0.9rem;
            color: #8B4513;
            justify-content: center;
            font-weight: bold;
        }

        .slice-effect {
            position: absolute;
            width: 100px;
            height: 100px;
            border-radius: 50%;
            background: radial-gradient(circle, rgba(255,255,0,0.8), transparent);
            pointer-events: none;
            animation: slice 0.3s ease-out;
        }

        .fruit-piece {
            position: absolute;
            font-size: 2rem;
            pointer-events: none;
            z-index: 60;
            animation: fruitFall 1s ease-in forwards;
        }

        @keyframes slice {
            0% { opacity: 1; transform: scale(0.5); }
            100% { opacity: 0; transform: scale(2); }
        }

        @keyframes fruitFall {
            0% { 
                opacity: 1; 
                transform: scale(1) rotate(0deg);
            }
            100% { 
                opacity: 0; 
                transform: scale(0.5) rotate(180deg) translateY(100px);
            }
        }

        .hidden {
            display: none !important;
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }

        @media (max-width: 768px) {
            .difficulty-buttons {
                gap: 10px;
            }
            
            .difficulty-btn {
                padding: 12px 15px;
                font-size: 1rem;
                min-width: 80px;
            }
            
            .difficulty-btn span {
                font-size: 0.7rem;
            }
            
            .intro-screen h1, .level-intro-screen h1 {
                font-size: 1.6rem;
                margin: 5px 0 15px 0;
            }
            
            .intro-screen p {
                font-size: 1rem !important;
                margin: 3px 15px !important;
            }
            
            .fruit-emoji {
                font-size: 2.2rem !important;
                width: 48px !important;
                height: 48px !important;
            }
            
            .fruit-emoji img {
                width: 48px !important;
                height: 48px !important;
            }
            
            .fruits-grid {
                grid-template-columns: repeat(4, 1fr);
                gap: 8px;
                margin: 10px;
                width: 95%;
                max-width: 350px;
            }
            
            .fruit-item {
                padding: 6px;
                min-height: 70px;
            }
            
            .fruit-name {
                font-size: 0.9rem;
            }
            
            .falling-fruit {
                font-size: 3rem;
            }
            
            .game-header {
                top: 5px;
                padding: 6px 12px;
                max-width: 95%;
            }
            
            .level-title {
                font-size: 0.9rem;
                margin-bottom: 3px;
            }
            
            .target-fruit .fruit-emoji {
                font-size: 1.1rem;
            }
            
            .target-fruit .fruit-name {
                font-size: 0.6rem;
            }
            
            .game-stats {
                font-size: 0.8rem;
                gap: 8px;
            }
            
            .start-button, .continue-button {
                font-size: 1.1rem;
                padding: 10px 20px;
                margin: 15px 15px 30px 15px;
                max-width: 85%;
            }
        }

        @media (max-width: 480px) {
            .intro-screen h1, .level-intro-screen h1 {
                font-size: 1.4rem;
            }
            
            .intro-screen p {
                font-size: 0.9rem !important;
            }
            
            .fruits-grid {
                grid-template-columns: repeat(3, 1fr);
                gap: 6px;
                width: 98%;
            }
            
            .fruit-item {
                padding: 4px;
                min-height: 60px;
            }
            
            .fruit-emoji {
                font-size: 2rem !important;
                width: 40px !important;
                height: 40px !important;
            }
            
            .fruit-emoji img {
                width: 40px !important;
                height: 40px !important;
            }
            
            .fruit-name {
                font-size: 0.8rem;
            }
            
            .start-button, .continue-button {
                font-size: 1rem;
                padding: 8px 16px;
            }
        }

        .memory-card {
            cursor: pointer;
            transition: all 0.3s ease;
            background: #f8f8ff;
            border-radius: 18px;
            box-shadow: 0 2px 8px #0001;
            border: 2px solid #eee;
            min-height: 100px;
            min-width: 100px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            font-size: 1.1rem;
            user-select: none;
        }
        
        .memory-card.selected {
            background: #e0ffe0;
            border: 2px solid #32CD32;
            box-shadow: 0 4px 16px #32cd3233;
            transform: scale(1.05);
        }
        
        .memory-card:hover {
            transform: scale(1.05);
        }

        .memory-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 18px;
            max-width: 420px;
            margin: 30px auto 20px auto;
            width: 100%;
        }

        .memory-card .fruit-emoji {
            width: 48px;
            height: 48px;
            margin-bottom: 6px;
        }

        .memory-card .fruit-name {
            font-size: 1.1rem;
            color: #8B4513;
            font-weight: bold;
            margin-bottom: 0;
        }

        .memory-controls {
            display: flex;
            justify-content: center;
            gap: 16px;
            margin-top: 18px;
        }

        .memory-controls button {
            padding: 12px 28px;
            border-radius: 18px;
            border: none;
            font-size: 1.1rem;
            font-weight: bold;
            background: #6c63ff;
            color: #fff;
            cursor: pointer;
            box-shadow: 0 2px 8px #0002;
            transition: 0.2s;
            opacity: 0.9;
        }

        .memory-controls button:disabled {
            background: #ccc;
            color: #888;
            cursor: not-allowed;
            opacity: 0.6;
        }

        .coin {
            position: fixed;
            width: 48px;
            height: 48px;
            background: #FFD700;
            border-radius: 50%;
            animation: fly 0.8s ease-out forwards;
            pointer-events: none;
            z-index: 150;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 32px;
            box-shadow: 0 4px 12px rgba(255, 215, 0, 0.5);
        }

        @keyframes fly {
            to {
                transform: translateY(-200px) scale(0);
                opacity: 0;
            }
        }

        #coinLabel {
            position: fixed;
            top: 10px;
            right: 10px;
            background: rgba(255,255,255,0.9);
            padding: 8px 12px;
            border-radius: 15px;
            font-weight: bold;
            color: #8B4513;
            z-index: 200;
            box-shadow: 0 2px 8px rgba(0,0,0,0.2);
        }

        #timerBox {
            position: fixed;
            top: 10px;
            left: 10px;
            background: rgba(255,255,255,0.95);
            padding: 15px 20px;
            border-radius: 20px;
            font-weight: bold;
            color: #8B4513;
            z-index: 200;
            box-shadow: 0 4px 12px rgba(0,0,0,0.3);
            font-size: 1.5rem;
            min-width: 100px;
            text-align: center;
            border: 3px solid #32CD32;
        }

        #timerBox.warning {
            border-color: #FF6B6B;
            background: rgba(255, 107, 107, 0.1);
            animation: pulse 1s infinite;
        }

        .slice-trail {
            position: absolute;
            width: 4px;
            height: 4px;
            background: #FFD700;
            border-radius: 50%;
            pointer-events: none;
            z-index: 60;
            animation: trailFade 0.5s ease-out forwards;
            box-shadow: 0 0 8px #FFD700;
        }

        @keyframes trailFade {
            0% { opacity: 1; transform: scale(1); }
            100% { opacity: 0; transform: scale(0.3); }
        }

        /* Responsive emoji sizes */
        @media (min-width: 1024px) {
            .fruit-emoji {
                width: 80px;
                height: 80px;
                font-size: 3rem;
            }
            
            .falling-fruit .fruit-emoji {
                width: 80px;
                height: 80px;
                font-size: 4rem;
            }
            
            .target-fruit .fruit-emoji {
                width: 60px;
                height: 60px;
                font-size: 2rem;
            }
            
            .memory-card .fruit-emoji {
                width: 64px;
                height: 64px;
            }
            
            .fruits-grid {
                grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
                gap: 20px;
                max-width: 800px;
            }
            
            .fruit-item {
                padding: 15px;
                min-height: 140px;
            }
            
            .fruit-name {
                font-size: 1.4rem;
            }
        }

        .level-score-animation {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(255,255,255,0.98);
            padding: 35px 45px;
            border-radius: 25px;
            text-align: center;
            z-index: 300;
            box-shadow: 0 12px 32px rgba(0,0,0,0.4);
            border: 4px solid #32CD32;
            animation: slideIn 0.5s ease-out;
        }

        @keyframes slideIn {
            0% { 
                opacity: 0; 
                transform: translate(-50%, -50%) scale(0.5);
            }
            100% { 
                opacity: 1; 
                transform: translate(-50%, -50%) scale(1);
            }
        }

        .level-intro-screen {
            padding-top: 10px;
        }

        .score-section {
            background: rgba(255,255,255,0.95);
            padding: 25px 35px;
            border-radius: 20px;
            text-align: center;
            margin: 20px auto;
            max-width: 400px;
            box-shadow: 0 8px 24px rgba(0,0,0,0.3);
            border: 3px solid #32CD32;
            animation: slideIn 0.5s ease-out;
        }

        .score-section .score-title {
            font-size: 1.6rem;
            color: #8B4513;
            margin-bottom: 15px;
            font-weight: bold;
        }

        .score-section .score-details {
            font-size: 1.1rem;
            color: #666;
            margin-bottom: 10px;
        }

        .score-section .score-counter {
            font-size: 2rem;
            font-weight: bold;
            margin: 10px 0;
        }

        .coin-rain {
            position: fixed;
            width: 48px;
            height: 48px;
            background: #FFD700;
            border-radius: 50%;
            pointer-events: none;
            z-index: 250;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 32px;
            box-shadow: 0 4px 12px rgba(255, 215, 0, 0.5);
        }

        .coin-rain.fall-left {
            animation: coinFallLeft 2s ease-in forwards;
        }

        .coin-rain.fall-right {
            animation: coinFallRight 2s ease-in forwards;
        }

        @keyframes coinFallLeft {
            0% { 
                transform: translateY(-100px) translateX(-200px) rotate(0deg);
                opacity: 1;
            }
            100% { 
                transform: translateY(100vh) translateX(-400px) rotate(720deg);
                opacity: 0;
            }
        }

        @keyframes coinFallRight {
            0% { 
                transform: translateY(-100px) translateX(200px) rotate(0deg);
                opacity: 1;
            }
            100% { 
                transform: translateY(100vh) translateX(400px) rotate(-720deg);
                opacity: 0;
            }
        }

        @keyframes countUp {
            0% { transform: scale(0.5); opacity: 0; }
            50% { transform: scale(1.2); opacity: 1; }
            100% { transform: scale(1); opacity: 1; }
        }

        .sparkle {
            position: fixed;
            width: 20px;
            height: 20px;
            pointer-events: none;
            z-index: 280;
            animation: sparkleFloat 1.5s ease-out forwards;
        }

        @keyframes sparkleFloat {
            0% { 
                opacity: 1; 
                transform: scale(0) rotate(0deg);
            }
            50% { 
                opacity: 1; 
                transform: scale(1) rotate(180deg);
            }
            100% { 
                opacity: 0; 
                transform: scale(0.3) rotate(360deg) translateY(-100px);
            }
        }

        @keyframes slideIn {
            0% { 
                opacity: 0; 
                transform: translate(-50%, -50%) scale(0.5);
            }
            100% { 
                opacity: 1; 
                transform: translate(-50%, -50%) scale(1);
            }
        }

        .next-level-button {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            padding: 15px 30px;
            font-size: 1.4rem;
            background: #32CD32;
            color: white;
            border: none;
            border-radius: 25px;
            cursor: pointer;
            box-shadow: 0 4px 12px rgba(0,0,0,0.3);
            transition: all 0.3s ease;
            z-index: 200;
            font-weight: bold;
            animation: pulse 2s infinite;
        }

        .next-level-button:hover {
            transform: translateX(-50%) scale(1.05);
            background: #28a745;
        }

        .start-button, .continue-button {
            font-size: 1.1rem;
            padding: 10px 20px;
            margin: 15px 15px 30px 15px;
            max-width: 85%;
        }

        .next-level-button {
            font-size: 1.1rem;
            padding: 12px 25px;
            bottom: 15px;
        }
    </style>
</head>
<body>
    <div class="game-container">
        <div id="coinLabel">üí∞ 0</div>
        <div id="timerBox" class="hidden">40</div>
        <!-- ◊û◊°◊ö ◊§◊™◊ô◊ó◊î -->
        <div class="intro-screen" id="introScreen">
            <h1>üåü ◊©◊ë◊¢◊™ ◊î◊û◊ô◊†◊ô◊ù ◊†◊ô◊†◊í'◊î üåü</h1>
            <p style="font-size: 1.3rem; margin-bottom: 15px; color: #8B4513; font-weight: bold;">◊ú◊ó◊¶◊ï ◊¢◊ú ◊õ◊ú ◊ê◊ó◊ì ◊û◊©◊ë◊¢◊™ ◊î◊û◊ô◊†◊ô◊ù ◊õ◊ì◊ô ◊ú◊î◊õ◊ô◊® ◊ê◊ï◊™◊ù</p>
            <p style="font-size: 1.1rem; margin-bottom: 20px; color: #D2691E;">◊ú◊ê◊ó◊® ◊û◊õ◊ü ◊†◊ï◊õ◊ú ◊ú◊î◊™◊ó◊ô◊ú ◊ú◊©◊ó◊ß!</p>
            <div class="fruits-grid">
                <div class="fruit-item" data-fruit="wheat">
                    <div class="fruit-emoji">üåæ</div>
                    <div class="fruit-name">◊ó◊ô◊ò◊î</div>
                </div>
                <div class="fruit-item" data-fruit="barley">
                    <div class="fruit-emoji">üåø</div>
                    <div class="fruit-name">◊©◊¢◊ï◊®◊î</div>
                </div>
                <div class="fruit-item" data-fruit="grape">
                    <div class="fruit-emoji">üçá</div>
                    <div class="fruit-name">◊¢◊†◊ë◊ô◊ù</div>
                </div>
                <div class="fruit-item" data-fruit="fig">
                    <img src="fig_64.png" class="fruit-emoji" alt="◊™◊ê◊†◊î">
                    <div class="fruit-name">◊™◊ê◊†◊î</div>
                </div>
                <div class="fruit-item" data-fruit="pomegranate">
                    <img src="pomegranate_64.png" class="fruit-emoji" alt="◊®◊ô◊û◊ï◊ü">
                    <div class="fruit-name">◊®◊ô◊û◊ï◊ü</div>
                </div>
                <div class="fruit-item" data-fruit="olive">
                    <img src="olive_transparent_64.png" class="fruit-emoji" alt="◊ñ◊ô◊™">
                    <div class="fruit-name">◊ñ◊ô◊™</div>
                </div>
                <div class="fruit-item" data-fruit="date">
                    <div class="fruit-emoji">üå¥</div>
                    <div class="fruit-name">◊™◊û◊®</div>
                </div>
            </div>
            
            <!-- ◊ë◊ó◊ô◊®◊™ ◊®◊û◊™ ◊ß◊ï◊©◊ô -->
            <div class="difficulty-selector" id="difficultySelector" style="display: none;">
                <h2 style="color: #8B4513; margin: 20px 0 15px 0; font-size: 1.4rem;">üéØ ◊ë◊ó◊®◊ï ◊®◊û◊™ ◊ß◊ï◊©◊ô:</h2>
                <div class="difficulty-buttons">
                    <button class="difficulty-btn" data-difficulty="1">
                        üêå ◊ê◊ô◊ò◊ô<br><span>3 ◊ì◊ß◊ï◊™</span>
                    </button>
                    <button class="difficulty-btn" data-difficulty="2">
                        üöÄ ◊ë◊ô◊†◊ï◊†◊ô<br><span>1:30 ◊ì◊ß◊ï◊™</span>
                    </button>
                    <button class="difficulty-btn" data-difficulty="3">
                        ‚ö° ◊û◊î◊ô◊®<br><span>45 ◊©◊†◊ô◊ï◊™</span>
                    </button>
                </div>
            </div>
            
            <button class="start-button" id="startGameBtn" style="display: none;">◊ú◊ó◊¶◊ï ◊¢◊ú ◊õ◊ú ◊î◊û◊ô◊†◊ô◊ù ◊õ◊ì◊ô ◊ú◊î◊™◊ó◊ô◊ú</button>
        </div>

        <!-- ◊û◊°◊ö ◊î◊¶◊í◊™ ◊©◊ú◊ë -->
        <div class="level-intro-screen hidden" id="levelIntroScreen">
            <h1 id="levelIntroTitle">◊©◊ú◊ë 1</h1>
            <p style="font-size: 1.3rem; margin-bottom: 20px; color: #8B4513;">◊ó◊™◊õ◊ï ◊ê◊™ ◊î◊û◊ô◊†◊ô◊ù ◊î◊ë◊ê◊ô◊ù:</p>
            <div id="levelIntroFruits">
                <!-- ◊ô◊ô◊ï◊ï◊°◊£ ◊ì◊ô◊†◊û◊ô◊™ -->
            </div>
            <button class="continue-button" id="continueBtn">◊î◊û◊©◊ö ◊ú◊©◊ú◊ë!</button>
        </div>

        <!-- ◊û◊°◊ö ◊î◊û◊©◊ó◊ß -->
        <div class="game-screen hidden" id="gameScreen">
            <div class="game-header">
                <div class="level-title" id="currentLevelTitle">◊©◊ú◊ë 1 - ◊ó◊™◊õ◊ï:</div>
                <div class="target-fruits" id="targetFruitsDisplay">
                    <!-- ◊ô◊ô◊ï◊ï◊°◊£ ◊ì◊ô◊†◊û◊ô◊™ -->
                </div>
                <div class="game-stats">
                    <span>◊†◊ß◊ï◊ì◊ï◊™: <span id="score">0</span></span>
                    <span>◊ô◊¢◊ì: <span id="cutsLabel">0/5 ◊ó◊™◊õ◊ô◊ù</span></span>
                    <span>◊ó◊ô◊ô◊ù: <span id="lives">‚ù§Ô∏è‚ù§Ô∏è‚ù§Ô∏è</span></span>
                </div>
            </div>
            
            <!-- ◊õ◊§◊™◊ï◊® ◊û◊¢◊ë◊® ◊ú◊©◊ú◊ë ◊î◊ë◊ê -->
            <button class="next-level-button hidden" id="nextLevelBtn">
                üéØ ◊¢◊ë◊ï◊® ◊ú◊©◊ú◊ë ◊î◊ë◊ê! üéØ
            </button>
        </div>
    </div>

    <script>
        // ◊û◊©◊™◊†◊ô ◊û◊©◊ó◊ß
        const fruits = {
            wheat: { emoji: 'üåæ', name: '◊ó◊ô◊ò◊î', points: 1 },
            barley: { emoji: 'üåø', name: '◊©◊¢◊ï◊®◊î', points: 1 },
            grape: { emoji: 'üçá', name: '◊¢◊†◊ë◊ô◊ù', points: 2 },
            fig: { emoji: 'fig_64.png', name: '◊™◊ê◊†◊î', points: 2 },
            pomegranate: { emoji: 'pomegranate_64.png', name: '◊®◊ô◊û◊ï◊ü', points: 3 },
            olive: { emoji: 'olive_transparent_64.png', name: '◊ñ◊ô◊™', points: 3 },
            date: { emoji: 'üå¥', name: '◊™◊û◊®', points: 3 }
        };

        const DISTRACTORS = {
            apple: { emoji: 'üçè', name: '◊™◊§◊ï◊ó' },
            banana: { emoji: 'üçå', name: '◊ë◊†◊†◊î' },
            carrot: { emoji: 'ü•ï', name: '◊í◊ñ◊®' },
            strawberry: { emoji: 'üçì', name: '◊™◊ï◊™' },
            orange: { emoji: 'üçä', name: '◊™◊§◊ï◊ñ' },
            pear: { emoji: 'üçê', name: '◊ê◊í◊°' },
            cucumber: { emoji: 'ü•í', name: '◊û◊ú◊§◊§◊ï◊ü' },
            tomato: { emoji: 'üçÖ', name: '◊¢◊í◊ë◊†◊ô◊î' },
            pepper: { emoji: 'üå∂Ô∏è', name: '◊§◊ú◊§◊ú' }
        };

        const DIFFICULTY = {
            1: { spawnInterval: 2000, v0: 2, vRand: 3, acceleration: 0, burstChance: 0, timeLimit: 180 }, // 3 ◊ì◊ß◊ï◊™
            2: { spawnInterval: 1200, v0: 4, vRand: 3, acceleration: 0, burstChance: 0.15, timeLimit: 90 }, // ◊ì◊ß◊î ◊ï◊ó◊¶◊ô
            3: { spawnInterval: 800, v0: 7, vRand: 4, acceleration: 0.25, burstChance: 0.35, timeLimit: 45 } // 45 ◊©◊†◊ô◊ï◊™
        };

        const LEVELS = [
            { 
                title: '◊©◊ú◊ë 1 - ◊ó◊™◊õ◊ï:', 
                targets: ['wheat', 'barley'],
                description: '◊ó◊ô◊ò◊î ◊ï◊©◊¢◊ï◊®◊î'
            },
            { 
                title: '◊©◊ú◊ë 2 - ◊ó◊™◊õ◊ï:', 
                targets: ['grape', 'fig'],
                description: '◊¢◊†◊ë◊ô◊ù ◊ï◊™◊ê◊†◊ô◊ù'
            },
            { 
                title: '◊©◊ú◊ë 3 - ◊ó◊™◊õ◊ï:', 
                targets: ['olive', 'date', 'pomegranate'],
                description: '◊ñ◊ô◊™◊ô◊ù, ◊™◊û◊®◊ô◊ù ◊ï◊®◊ô◊û◊ï◊†◊ô◊ù'
            },
            {
                title: '◊©◊ú◊ë 4 - ◊ñ◊ô◊î◊ï◊ô ◊©◊ë◊¢◊™ ◊î◊û◊ô◊†◊ô◊ù',
                type: 'memory',
                description: '◊ñ◊ô◊î◊ï ◊ê◊™ ◊©◊ë◊¢◊™ ◊î◊û◊ô◊†◊ô◊ù ◊û◊™◊ï◊ö ◊î◊ß◊ú◊§◊ô◊ù'
            }
        ];

        let currentLevel = 0;
        let score = 0;
        let lives = 3;
        let correctCuts = 0;
        let levelPoints = 0; // ◊ê◊ô◊§◊ï◊° ◊†◊ß◊ï◊ì◊ï◊™ ◊î◊©◊ú◊ë
        let gameActive = false;
        let fallingFruits = [];
        let spawnRate = 2000;
        let gameInterval;
        let spawnInterval;
        let timerInterval;
        let timeLeft = 40;
        let clickedFruits = new Set();
        let baseSpeed, randSpeed;
        let coins = 0;
        let currentDifficulty = 1;

        // ◊ê◊ú◊û◊†◊ò◊ô◊ù
        const introScreen = document.getElementById('introScreen');
        const levelIntroScreen = document.getElementById('levelIntroScreen');
        const gameScreen = document.getElementById('gameScreen');
        const startGameBtn = document.getElementById('startGameBtn');
        const continueBtn = document.getElementById('continueBtn');

        // ◊î◊ß◊®◊ê◊™ ◊©◊û◊ï◊™ ◊ë◊§◊™◊ô◊ó◊î
        document.querySelectorAll('.fruit-item').forEach(item => {
            item.addEventListener('click', () => {
                const fruitKey = item.dataset.fruit;
                const fruitName = fruits[fruitKey].name;
                // ◊î◊°◊®◊™ ◊î◊ß◊ï◊ú - speak(fruitName);
                
                // ◊î◊ï◊°◊§◊™ ◊ê◊ô◊†◊ì◊ô◊ß◊¶◊ô◊î ◊©◊†◊ú◊ó◊•
                if (!item.classList.contains('clicked')) {
                    item.classList.add('clicked');
                    
                    // ◊î◊ï◊°◊§◊™ V
                    const checkMark = document.createElement('div');
                    checkMark.className = 'check-mark';
                    checkMark.textContent = '‚úì';
                    item.appendChild(checkMark);
                    
                    clickedFruits.add(fruitKey);
                }
                
                // ◊¢◊ì◊õ◊ï◊ü ◊õ◊§◊™◊ï◊®
                updateStartButton();
            });
        });

        function updateStartButton() {
            const startBtn = document.getElementById('startGameBtn');
            const difficultySelector = document.getElementById('difficultySelector');
            
            startBtn.style.display = 'block';
            
            if (clickedFruits.size === 7) {
                difficultySelector.style.display = 'block';
                startBtn.classList.add('ready');
                startBtn.textContent = 'üéÆ ◊î◊™◊ó◊ô◊ú◊ï ◊ú◊©◊ó◊ß! üéÆ';
                startBtn.style.cursor = 'pointer';
            } else {
                difficultySelector.style.display = 'none';
                startBtn.classList.remove('ready');
                const remaining = 7 - clickedFruits.size;
                startBtn.textContent = `◊¢◊ï◊ì ${remaining} ◊û◊ô◊†◊ô◊ù ◊ú◊§◊†◊ô ◊©◊û◊™◊ó◊ô◊ú◊ô◊ù...`;
                startBtn.style.cursor = 'not-allowed';
            }
        }

        // ◊ë◊ó◊ô◊®◊™ ◊®◊û◊™ ◊ß◊ï◊©◊ô
        document.querySelectorAll('.difficulty-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                // ◊î◊°◊®◊™ ◊ë◊ó◊ô◊®◊î ◊ß◊ï◊ì◊û◊™
                document.querySelectorAll('.difficulty-btn').forEach(b => b.classList.remove('selected'));
                
                // ◊ë◊ó◊ô◊®◊î ◊ó◊ì◊©◊î
                btn.classList.add('selected');
                currentDifficulty = parseInt(btn.dataset.difficulty);
                
                console.log('Selected difficulty:', currentDifficulty);
            });
        });

        // ◊ë◊ó◊ô◊®◊™ ◊®◊û◊î 1 ◊õ◊ë◊®◊ô◊®◊™ ◊û◊ó◊ì◊ú
        document.querySelector('.difficulty-btn[data-difficulty="1"]').classList.add('selected');
        currentDifficulty = 1;

        // ◊î◊™◊ó◊ú◊™ ◊û◊©◊ó◊ß
        startGameBtn.addEventListener('click', () => {
            if (clickedFruits.size === 7) {
                showLevelIntro();
            } else {
                const remaining = 7 - clickedFruits.size;
                alert(`◊¢◊ì◊ô◊ô◊ü ◊¶◊®◊ô◊ö ◊ú◊ú◊ó◊ï◊• ◊¢◊ú ${remaining} ◊û◊ô◊†◊ô◊ù ◊†◊ï◊°◊§◊ô◊ù!`);
            }
        });

        continueBtn.addEventListener('click', startLevel);

        function showLevelIntro() {
            introScreen.classList.add('hidden');
            levelIntroScreen.classList.remove('hidden');
            
            // ◊î◊¶◊í◊™ ◊õ◊§◊™◊ï◊® ◊î◊û◊©◊ö
            const continueBtn = document.getElementById('continueBtn');
            continueBtn.style.display = 'block';
            
            const level = LEVELS[currentLevel];
            document.getElementById('levelIntroTitle').textContent = `◊©◊ú◊ë ${currentLevel + 1}`;
            
            const fruitsContainer = document.getElementById('levelIntroFruits');
            fruitsContainer.innerHTML = '';
            
            // ◊†◊ô◊ß◊ï◊ô ◊û◊°◊õ◊ô ◊™◊ï◊¶◊ê◊ï◊™ ◊ß◊ï◊ì◊û◊ô◊ù
            const existingScoreSections = levelIntroScreen.querySelectorAll('.score-section');
            existingScoreSections.forEach(section => section.remove());
            
            level.targets.forEach(fruitKey => {
                const fruit = fruits[fruitKey];
                const fruitDiv = document.createElement('div');
                fruitDiv.className = 'fruit-item';
                fruitDiv.innerHTML = `
                    ${getFruitHTML(fruitKey)}
                    <div class="fruit-name">${fruit.name}</div>
                `;
                fruitDiv.addEventListener('click', () => {
                    // ◊î◊°◊®◊™ ◊î◊ß◊ï◊ú - speak(fruit.name);
                    fruitDiv.style.transform = 'scale(1.2)';
                    setTimeout(() => {
                        fruitDiv.style.transform = 'scale(1)';
                    }, 200);
                });
                fruitsContainer.appendChild(fruitDiv);
            });
        }

        function startLevel() {
            levelIntroScreen.classList.add('hidden');
            gameScreen.classList.remove('hidden');
            
            // ◊î◊¶◊í◊™ ◊ò◊ô◊ô◊û◊®
            document.getElementById('timerBox').classList.remove('hidden');
            
            // ◊î◊°◊™◊®◊™ ◊õ◊§◊™◊ï◊® ◊û◊¢◊ë◊® ◊ú◊©◊ú◊ë ◊î◊ë◊ê
            document.getElementById('nextLevelBtn').classList.add('hidden');
            
            // ◊ê◊ô◊§◊ï◊° ◊û◊©◊™◊†◊ô◊ù
            correctCuts = 0;
            levelPoints = 0; // ◊ê◊ô◊§◊ï◊° ◊†◊ß◊ï◊ì◊ï◊™ ◊î◊©◊ú◊ë
            lives = 3;
            timeLeft = DIFFICULTY[currentDifficulty].timeLimit; // ◊ñ◊û◊ü ◊ú◊§◊ô ◊®◊û◊™ ◊ß◊ï◊©◊ô
            gameActive = true;
            
            updateUI();
            initSliceEvents(); // ◊î◊§◊¢◊ú◊™ ◊ê◊ô◊®◊ï◊¢◊ô ◊ó◊ô◊™◊ï◊ö
            startGameLoop();
            startTimer();
            
            console.log('Game started - slice events initialized'); // ◊ì◊ô◊ë◊ï◊í
        }

        function startTimer() {
            const timerBox = document.getElementById('timerBox');
            timerBox.textContent = formatTime(timeLeft);
            timerBox.classList.remove('warning');
            
            timerInterval = setInterval(() => {
                timeLeft--;
                timerBox.textContent = formatTime(timeLeft);
                
                // ◊ê◊ñ◊î◊®◊î ◊õ◊©◊†◊©◊ê◊®◊ï 10 ◊©◊†◊ô◊ï◊™
                if (timeLeft <= 10) {
                    timerBox.classList.add('warning');
                }
                
                if (timeLeft <= 0) {
                    timeUp();
                }
            }, 1000);
        }

        function formatTime(seconds) {
            const minutes = Math.floor(seconds / 60);
            const remainingSeconds = seconds % 60;
            return minutes > 0 ? `${minutes}:${remainingSeconds.toString().padStart(2, '0')}` : remainingSeconds.toString();
        }

        function timeUp() {
            gameActive = false;
            clearInterval(gameInterval);
            clearInterval(spawnInterval);
            clearInterval(timerInterval);
            
            // ◊î◊°◊™◊®◊™ ◊ò◊ô◊ô◊û◊®
            document.getElementById('timerBox').classList.add('hidden');
            
            // ◊†◊ô◊ß◊ï◊ô ◊§◊ô◊®◊ï◊™ ◊†◊ï◊§◊ú◊ô◊ù
            fallingFruits.forEach(fruit => fruit.element.remove());
            fallingFruits = [];
            
            if (correctCuts >= 5) {
                alert(`◊õ◊ú ◊î◊õ◊ë◊ï◊ì! ◊°◊ô◊ô◊û◊™◊ù ◊ê◊™ ◊©◊ú◊ë ${currentLevel + 1} ◊ë◊ñ◊û◊ü!`);
                levelComplete();
            } else {
                alert(`◊î◊ñ◊û◊ü ◊†◊í◊û◊®! ◊î◊¶◊ú◊ó◊™◊ù ◊ú◊ó◊™◊ï◊ö ${correctCuts}/5 ◊û◊ô◊†◊ô◊ù. ◊†◊°◊ï ◊©◊ï◊ë!`);
                gameOver();
            }
        }

        function updateUI() {
            const level = LEVELS[currentLevel];
            document.getElementById('currentLevelTitle').textContent = level.title;
            document.getElementById('score').textContent = score;
            document.getElementById('cutsLabel').textContent = `${correctCuts}/5 ◊ó◊™◊õ◊ô◊ù`;
            document.getElementById('lives').textContent = `‚ù§Ô∏è ${lives}`;
            
            const targetDisplay = document.getElementById('targetFruitsDisplay');
            targetDisplay.innerHTML = '';
            
            level.targets.forEach(fruitKey => {
                const fruit = fruits[fruitKey];
                const targetDiv = document.createElement('div');
                targetDiv.className = 'target-fruit';
                targetDiv.innerHTML = `
                    ${getFruitHTML(fruitKey)}
                    <div class="fruit-name">${fruit.name} (${fruit.points})</div>
                `;
                targetDisplay.appendChild(targetDiv);
            });

            // ◊î◊¶◊í◊™/◊î◊°◊™◊®◊™ ◊õ◊§◊™◊ï◊® ◊û◊¢◊ë◊® ◊ú◊©◊ú◊ë ◊î◊ë◊ê
            const nextLevelBtn = document.getElementById('nextLevelBtn');
            if (correctCuts >= 5) {
                nextLevelBtn.classList.remove('hidden');
            } else {
                nextLevelBtn.classList.add('hidden');
            }
        }

        function startGameLoop() {
            const currentRules = DIFFICULTY[currentDifficulty || 1];
            spawnInterval = setInterval(spawnFruit, currentRules.spawnInterval);
            gameInterval = setInterval(updateGame, 50);
        }

        function spawnFruit() {
            if (!gameActive) return;
            
            console.log('Spawning fruit - gameActive:', gameActive, 'currentDifficulty:', currentDifficulty);
            
            const currentRules = DIFFICULTY[currentDifficulty || 1];
            const level = LEVELS[currentLevel];
            const allFruits = [...level.targets, ...Object.keys(DISTRACTORS)];
            const randomFruit = allFruits[Math.floor(Math.random() * allFruits.length)];
            
            let fruit, isTarget;
            if (level.targets.includes(randomFruit)) {
                fruit = fruits[randomFruit];
                isTarget = true;
            } else {
                fruit = DISTRACTORS[randomFruit];
                isTarget = false;
            }
            
            const fruitElement = document.createElement('div');
            fruitElement.className = 'falling-fruit';
            
            if (level.targets.includes(randomFruit)) {
                fruitElement.innerHTML = getFruitHTML(randomFruit);
            } else {
                fruitElement.innerHTML = `<div class="fruit-emoji">${fruit.emoji}</div>`;
            }
            
            fruitElement.style.left = Math.random() * (window.innerWidth - 80) + 'px';
            fruitElement.style.top = '-80px';
            fruitElement.dataset.isTarget = isTarget;
            fruitElement.dataset.fruitKey = randomFruit;
            fruitElement.style.pointerEvents = 'auto';
            
            const speed = currentRules.v0 + Math.random() * currentRules.vRand;
            fallingFruits.push({
                element: fruitElement,
                y: -80,
                speed: speed,
                acceleration: currentRules.acceleration
            });
            
            gameScreen.appendChild(fruitElement);
            console.log('Fruit spawned:', randomFruit, 'isTarget:', isTarget, 'speed:', speed);
        }

        let isSlicing = false;
        let lastSliceTime = 0;
        let sliceEventsInitialized = false;

        // ◊ê◊ô◊®◊ï◊¢◊ô ◊ó◊ô◊™◊ï◊ö ◊í◊ú◊ï◊ë◊ú◊ô◊ô◊ù
        function initSliceEvents() {
            if (sliceEventsInitialized) return;
            sliceEventsInitialized = true;
            
            // ◊ê◊ô◊®◊ï◊¢◊ô ◊¢◊õ◊ë◊®
            gameScreen.addEventListener('mousedown', startSlice);
            document.addEventListener('mousemove', handleSlice);
            document.addEventListener('mouseup', endSlice);
            
            // ◊ê◊ô◊®◊ï◊¢◊ô ◊û◊í◊¢
            gameScreen.addEventListener('touchstart', startSlice, { passive: false });
            document.addEventListener('touchmove', handleSlice, { passive: false });
            document.addEventListener('touchend', endSlice);
        }

        function startSlice(e) {
            if (!gameActive) return;
            console.log('Start slice - gameActive:', gameActive);
            e.preventDefault();
            isSlicing = true;
            document.body.classList.add('slicing'); // ◊î◊ï◊°◊§◊™ ◊°◊û◊ü ◊ó◊®◊ë
            handleSlice(e);
        }

        function handleSlice(e) {
            if (!isSlicing || !gameActive) return;
            
            const currentTime = Date.now();
            if (currentTime - lastSliceTime < 50) return;
            lastSliceTime = currentTime;
            
            let x, y;
            if (e.type.includes('touch')) {
                if (e.touches && e.touches[0]) {
                    x = e.touches[0].clientX;
                    y = e.touches[0].clientY;
                }
            } else {
                x = e.clientX;
                y = e.clientY;
            }
            
            if (!x || !y) return;
            
            // ◊ô◊¶◊ô◊®◊™ ◊ê◊§◊ß◊ò ◊ó◊ô◊™◊ï◊ö ◊ó◊ñ◊ï◊™◊ô
            createSliceTrail(x, y);
            
            // ◊ó◊ô◊§◊ï◊© ◊§◊ô◊®◊ï◊™ ◊ë◊†◊ß◊ï◊ì◊™ ◊î◊ó◊ô◊™◊ï◊ö
            const elements = document.elementsFromPoint(x, y);
            const fruitElement = elements.find(el => el.classList.contains('falling-fruit'));
            
            console.log('Handle slice - x:', x, 'y:', y, 'fruitElement:', fruitElement);
            
            if (fruitElement && !fruitElement.dataset.cut) {
                console.log('Cutting fruit:', fruitElement.dataset.fruitKey);
                cutFruit(fruitElement, x, y);
                fruitElement.dataset.cut = 'true';
            }
        }

        function endSlice(e) {
            isSlicing = false;
            document.body.classList.remove('slicing'); // ◊î◊°◊®◊™ ◊°◊û◊ü ◊ó◊®◊ë
        }

        function cutFruit(fruitElement, x, y) {
            const isTarget = fruitElement.dataset.isTarget === 'true';
            const fruitKey = fruitElement.dataset.fruitKey;
            
            // ◊ô◊¶◊ô◊®◊™ ◊ó◊ú◊ß◊ô ◊§◊®◊ô
            createFruitPieces(fruitElement, fruitKey);
            
            // ◊ê◊§◊ß◊ò ◊ó◊ô◊™◊ï◊ö
            createSliceEffect(x, y);
            
            if (isTarget) {
                const fruitPoints = fruits[fruitKey].points;
                score += fruitPoints;
                levelPoints += fruitPoints; // ◊î◊ï◊°◊§◊™ ◊†◊ß◊ï◊ì◊ï◊™ ◊ú◊©◊ú◊ë
                correctCuts++;
                
                // ◊ú◊ê ◊¢◊ï◊ë◊®◊ô◊ù ◊©◊ú◊ë ◊ê◊ï◊ò◊ï◊û◊ò◊ô◊™ - ◊î◊©◊ó◊ß◊ü ◊ô◊õ◊ï◊ú ◊ú◊î◊û◊©◊ô◊ö ◊ú◊¶◊ë◊ï◊® ◊†◊ß◊ï◊ì◊ï◊™
            } else {
                lives--;
                if (lives <= 0) {
                    gameOver();
                }
            }
            
            // ◊î◊°◊®◊™ ◊î◊§◊®◊ô
            fruitElement.remove();
            fallingFruits = fallingFruits.filter(f => f.element !== fruitElement);
            
            updateUI();
        }

        function createFruitPieces(fruitElement, fruitKey) {
            const rect = fruitElement.getBoundingClientRect();
            const centerX = rect.left + rect.width / 2;
            const centerY = rect.top + rect.height / 2;
            
            // ◊ô◊¶◊ô◊®◊™ 3-4 ◊ó◊ú◊ß◊ô◊ù
            const numPieces = 3 + Math.floor(Math.random() * 2);
            
            for (let i = 0; i < numPieces; i++) {
                const piece = document.createElement('div');
                piece.className = 'fruit-piece';
                
                // ◊ë◊ó◊ô◊®◊™ ◊™◊¶◊ï◊í◊î ◊ú◊ó◊ú◊ß
                if (fruits[fruitKey]) {
                    piece.innerHTML = getFruitHTML(fruitKey);
                } else {
                    piece.innerHTML = `<div class="fruit-emoji">${DISTRACTORS[fruitKey].emoji}</div>`;
                }
                
                piece.style.left = centerX + 'px';
                piece.style.top = centerY + 'px';
                
                // ◊õ◊ô◊ï◊ï◊ü ◊ê◊ß◊®◊ê◊ô ◊ú◊õ◊ú ◊ó◊ú◊ß
                const angle = (360 / numPieces) * i + Math.random() * 60;
                const distance = 50 + Math.random() * 50;
                const endX = centerX + Math.cos(angle * Math.PI / 180) * distance;
                const endY = centerY + Math.sin(angle * Math.PI / 180) * distance + 100;
                
                piece.style.setProperty('--endX', endX + 'px');
                piece.style.setProperty('--endY', endY + 'px');
                
                // ◊¢◊ì◊õ◊ï◊ü ◊î◊ê◊†◊ô◊û◊¶◊ô◊î ◊¢◊ù ◊î◊õ◊ô◊ï◊ï◊ü ◊î◊ó◊ì◊©
                piece.style.animation = `fruitFall${i} 1s ease-in forwards`;
                
                // ◊ô◊¶◊ô◊®◊™ ◊ê◊†◊ô◊û◊¶◊ô◊î ◊ì◊ô◊†◊û◊ô◊™
                const keyframes = `
                    @keyframes fruitFall${i} {
                        0% { 
                            opacity: 1; 
                            transform: scale(1) rotate(0deg);
                            left: ${centerX}px;
                            top: ${centerY}px;
                        }
                        100% { 
                            opacity: 0; 
                            transform: scale(0.3) rotate(${180 + Math.random() * 180}deg);
                            left: ${endX}px;
                            top: ${endY}px;
                        }
                    }
                `;
                
                // ◊î◊ï◊°◊§◊™ ◊î◊ê◊†◊ô◊û◊¶◊ô◊î ◊ú◊¢◊û◊ï◊ì
                const style = document.createElement('style');
                style.textContent = keyframes;
                document.head.appendChild(style);
                
                gameScreen.appendChild(piece);
                
                // ◊î◊°◊®◊™ ◊î◊ó◊ú◊ß ◊ê◊ó◊®◊ô ◊î◊ê◊†◊ô◊û◊¶◊ô◊î
                setTimeout(() => {
                    piece.remove();
                    style.remove();
                }, 1000);
            }
        }

        function createSliceEffect(x, y) {
            const effect = document.createElement('div');
            effect.className = 'slice-effect';
            effect.style.left = (x - 50) + 'px';
            effect.style.top = (y - 50) + 'px';
            gameScreen.appendChild(effect);
            
            setTimeout(() => effect.remove(), 300);
        }

        function createSliceTrail(x, y) {
            const trail = document.createElement('div');
            trail.className = 'slice-trail';
            trail.style.left = x + 'px';
            trail.style.top = y + 'px';
            document.body.appendChild(trail);
            
            setTimeout(() => trail.remove(), 500);
        }

        function updateGame() {
            if (!gameActive) return;
            
            fallingFruits.forEach((fruit, index) => {
                fruit.speed += fruit.acceleration || 0;
                fruit.y += fruit.speed;
                fruit.element.style.top = fruit.y + 'px';
                
                if (fruit.y > window.innerHeight) {
                    fruit.element.remove();
                    fallingFruits.splice(index, 1);
                }
            });
        }

        function levelComplete() {
            gameActive = false;
            clearInterval(gameInterval);
            clearInterval(spawnInterval);
            clearInterval(timerInterval);
            
            // ◊î◊°◊™◊®◊™ ◊ò◊ô◊ô◊û◊®
            document.getElementById('timerBox').classList.add('hidden');
            
            // ◊†◊ô◊ß◊ï◊ô ◊§◊ô◊®◊ï◊™ ◊†◊ï◊§◊ú◊ô◊ù
            fallingFruits.forEach(fruit => fruit.element.remove());
            fallingFruits = [];
            
            // ◊î◊ï◊°◊§◊™ ◊û◊ò◊ë◊¢◊ï◊™ - ◊û◊ò◊ë◊¢ ◊ê◊ó◊ì ◊ú◊õ◊ú ◊†◊ß◊ï◊ì◊î
            const earned = levelPoints;
            const oldCoins = coins;
            coins += earned;
            
            currentLevel++;
            
            if (currentLevel >= LEVELS.length) {
                gameWin();
            } else if (LEVELS[currentLevel].type === 'memory') {
                startMemoryGame();
            } else {
                // ◊û◊¢◊ë◊® ◊ú◊û◊°◊ö ◊ë◊ô◊†◊ô◊ô◊ù ◊¢◊ù ◊ê◊†◊ô◊û◊¶◊ô◊ô◊™ ◊†◊ß◊ï◊ì◊ï◊™ ◊ï◊û◊ò◊ë◊¢◊ï◊™
                gameScreen.classList.add('hidden');
                showLevelIntroWithAnimation(earned, oldCoins);
            }
        }

        function showLevelIntroWithAnimation(earnedCoins, oldCoins) {
            showLevelIntro();
            
            // ◊ó◊ô◊©◊ï◊ë ◊†◊ß◊ï◊ì◊ï◊™ ◊©◊î◊ï◊©◊í◊ï ◊ë◊©◊ú◊ë ◊î◊†◊ï◊õ◊ó◊ô
            const pointsEarned = levelPoints;
            const previousScore = score - pointsEarned;
            
            // ◊î◊ï◊°◊§◊™ ◊û◊°◊ö ◊î◊™◊ï◊¶◊ê◊ï◊™ ◊ú◊û◊°◊ö ◊î◊û◊¢◊ë◊®
            const levelIntroFruits = document.getElementById('levelIntroFruits');
            
            // ◊ô◊¶◊ô◊®◊™ ◊û◊°◊ö ◊ê◊†◊ô◊û◊¶◊ô◊ô◊™ ◊†◊ß◊ï◊ì◊ï◊™ ◊ë◊™◊ï◊ö ◊î◊û◊°◊ö ◊î◊ß◊ô◊ô◊ù
            const scoreSection = document.createElement('div');
            scoreSection.className = 'score-section';
            
            scoreSection.innerHTML = `
                <div style="font-size: 1.6rem; color: #8B4513; margin-bottom: 15px; font-weight: bold;">üéâ ◊õ◊ú ◊î◊õ◊ë◊ï◊ì! üéâ</div>
                <div style="font-size: 1.1rem; color: #666; margin-bottom: 10px;">◊°◊ô◊ô◊û◊™◊ù ◊ê◊™ ◊©◊ú◊ë ${currentLevel}!</div>
                <div style="font-size: 1rem; color: #666; margin-bottom: 15px;">◊¶◊ë◊®◊™◊ù ${pointsEarned} ◊†◊ß◊ï◊ì◊ï◊™ ◊ë◊©◊ú◊ë ◊ñ◊î</div>
                <div id="animatedScore" style="font-size: 2rem; color: #FF6B6B; font-weight: bold; margin: 10px 0;">‚≠ê ${previousScore}</div>
                <div style="font-size: 0.9rem; color: #666; margin: 5px 0;">+${pointsEarned} ◊†◊ß◊ï◊ì◊ï◊™!</div>
                <div id="animatedCoins" style="font-size: 2rem; color: #32CD32; font-weight: bold; margin: 10px 0;">üí∞ ${oldCoins}</div>
                <div style="font-size: 0.9rem; color: #666; margin-bottom: 15px;">+${earnedCoins} ◊û◊ò◊ë◊¢◊ï◊™ ◊ó◊ì◊©◊ô◊ù!</div>
                <div style="font-size: 0.8rem; color: #999; margin-top: 10px; font-style: italic;">◊î◊©◊ú◊ë ◊î◊ë◊ê ◊û◊™◊ó◊ô◊ú ◊õ◊©◊™◊ú◊ó◊¶◊ï "◊î◊û◊©◊ö ◊ú◊©◊ú◊ë"</div>
            `;
            
            // ◊î◊ï◊°◊§◊™ ◊î◊û◊°◊ö ◊ú◊§◊†◊ô ◊î◊§◊ô◊®◊ï◊™ ◊©◊ú ◊î◊©◊ú◊ë ◊î◊ë◊ê
            levelIntroFruits.parentNode.insertBefore(scoreSection, levelIntroFruits);
            
            // ◊ê◊†◊ô◊û◊¶◊ô◊ô◊™ ◊°◊§◊ô◊®◊™ ◊†◊ß◊ï◊ì◊ï◊™
            setTimeout(() => {
                const scoreCounter = document.getElementById('animatedScore');
                let currentScore = previousScore;
                const scoreIncrement = pointsEarned / 15;
                
                const scoreInterval = setInterval(() => {
                    currentScore += scoreIncrement;
                    if (currentScore >= score) {
                        currentScore = score;
                        clearInterval(scoreInterval);
                    }
                    scoreCounter.textContent = `‚≠ê ${Math.floor(currentScore)}`;
                    scoreCounter.style.animation = 'countUp 0.3s ease-out';
                }, 60);
            }, 300);
            
            // ◊ê◊†◊ô◊û◊¶◊ô◊ô◊™ ◊°◊§◊ô◊®◊™ ◊û◊ò◊ë◊¢◊ï◊™
            setTimeout(() => {
                const coinCounter = document.getElementById('animatedCoins');
                let currentCount = oldCoins;
                const increment = earnedCoins / 20;
                
                const countInterval = setInterval(() => {
                    currentCount += increment;
                    if (currentCount >= coins) {
                        currentCount = coins;
                        clearInterval(countInterval);
                    }
                    coinCounter.textContent = `üí∞ ${Math.floor(currentCount)}`;
                    coinCounter.style.animation = 'countUp 0.3s ease-out';
                }, 50);
                
                // ◊¢◊ì◊õ◊ï◊ü ◊î◊™◊¶◊ï◊í◊î ◊î◊í◊ú◊ï◊ë◊ú◊ô◊™
                document.getElementById('coinLabel').textContent = `üí∞ ${coins}`;
            }, 800);
            
            // ◊ê◊§◊ß◊ò ◊í◊©◊ù ◊û◊ò◊ë◊¢◊ï◊™
            for (let i = 0; i < earnedCoins; i++) {
                setTimeout(() => {
                    const coin = document.createElement('div');
                    coin.className = `coin-rain ${i % 2 === 0 ? 'fall-left' : 'fall-right'}`;
                    coin.textContent = 'üí∞';
                    coin.style.left = (window.innerWidth / 2 + (Math.random() - 0.5) * 200) + 'px';
                    coin.style.top = '0px';
                    document.body.appendChild(coin);
                    setTimeout(() => coin.remove(), 2000);
                }, i * 100 + 1000);
            }
            
            // ◊ê◊§◊ß◊ò ◊†◊ô◊¶◊ï◊¶◊ï◊™
            for (let i = 0; i < 15; i++) {
                setTimeout(() => {
                    const sparkle = document.createElement('div');
                    sparkle.className = 'sparkle';
                    sparkle.textContent = ['‚ú®', '‚≠ê', 'üí´', 'üåü'][Math.floor(Math.random() * 4)];
                    sparkle.style.left = (window.innerWidth / 2 + (Math.random() - 0.5) * 400) + 'px';
                    sparkle.style.top = (window.innerHeight / 2 + (Math.random() - 0.5) * 300) + 'px';
                    sparkle.style.fontSize = (16 + Math.random() * 8) + 'px';
                    document.body.appendChild(sparkle);
                    setTimeout(() => sparkle.remove(), 1500);
                }, i * 200 + 500);
            }
        }

        function startMemoryGame() {
            gameScreen.classList.add('hidden');
            levelIntroScreen.classList.remove('hidden');
            // ◊î◊°◊™◊® ◊õ◊§◊™◊ï◊® ◊î◊û◊©◊ö
            const continueBtn = document.getElementById('continueBtn');
            continueBtn.style.display = 'none';
            const level = LEVELS[currentLevel];
            document.getElementById('levelIntroTitle').textContent = level.title;
            // ◊¢◊ì◊õ◊ï◊ü ◊î◊î◊ï◊®◊ê◊î
            const levelIntroDesc = levelIntroScreen.querySelector('p');
            if (levelIntroDesc) levelIntroDesc.textContent = '◊ñ◊î◊ï ◊ê◊™ ◊©◊ë◊¢◊™ ◊î◊û◊ô◊†◊ô◊ù ◊û◊™◊ï◊ö ◊î◊ß◊ú◊§◊ô◊ù:';
            
            // ◊ô◊¶◊ô◊®◊™ ◊û◊¢◊®◊ö ◊©◊ú ◊õ◊ú ◊î◊ß◊ú◊§◊ô◊ù - ◊ß◊ï◊ì◊ù ◊©◊ë◊¢◊™ ◊î◊û◊ô◊†◊ô◊ù
            const sevenSpecies = Object.keys(fruits);
            const distractors = Object.keys(DISTRACTORS);
            
            // ◊¢◊®◊ë◊ï◊ë ◊î◊û◊°◊ô◊ó◊ô◊ù ◊ï◊ë◊ó◊ô◊®◊™ 9 ◊û◊î◊ù
            const shuffledDistractors = distractors.sort(() => Math.random() - 0.5).slice(0, 9);
            
            // ◊©◊ô◊ú◊ï◊ë ◊©◊ë◊¢◊™ ◊î◊û◊ô◊†◊ô◊ù ◊¢◊ù ◊î◊û◊°◊ô◊ó◊ô◊ù
            const allCards = [...sevenSpecies, ...shuffledDistractors];
            
            // ◊¢◊®◊ë◊ï◊ë ◊°◊ï◊§◊ô ◊©◊ú ◊õ◊ú ◊î◊ß◊ú◊§◊ô◊ù
            let shuffledCards = allCards.sort(() => Math.random() - 0.5);
            
            // ◊ô◊¶◊ô◊®◊™ ◊®◊©◊™ ◊î◊ß◊ú◊§◊ô◊ù
            const fruitsContainer = document.getElementById('levelIntroFruits');
            fruitsContainer.innerHTML = '';
            fruitsContainer.className = '';
            fruitsContainer.classList.add('memory-grid');
            shuffledCards.forEach(cardKey => {
                const cardDiv = document.createElement('div');
                cardDiv.className = 'memory-card';
                cardDiv.dataset.fruitKey = cardKey;
                const fruit = fruits[cardKey] || DISTRACTORS[cardKey];
                cardDiv.innerHTML = `
                    ${fruits[cardKey] ? getFruitHTML(cardKey) : `<div class="fruit-emoji">${fruit.emoji}</div>`}
                    <div class="fruit-name">${fruit.name}</div>
                `;
                cardDiv.addEventListener('click', () => handleCardClick(cardDiv));
                fruitsContainer.appendChild(cardDiv);
            });
            // ◊õ◊§◊™◊ï◊® ◊ë◊ì◊ï◊ß ◊™◊©◊ï◊ë◊ï◊™
            let controls = document.querySelector('.memory-controls');
            if (!controls) {
                controls = document.createElement('div');
                controls.className = 'memory-controls';
                const checkBtn = document.createElement('button');
                checkBtn.id = 'checkMemoryBtn';
                checkBtn.textContent = '◊ë◊ì◊ï◊ß ◊™◊©◊ï◊ë◊ï◊™';
                checkBtn.disabled = true;
                checkBtn.onclick = checkMemoryAnswers;
                controls.appendChild(checkBtn);
                fruitsContainer.parentNode.appendChild(controls);
            }
            // ◊ê◊ô◊§◊ï◊° ◊ë◊ó◊ô◊®◊ï◊™
            selectedCards.clear();
            document.getElementById('checkMemoryBtn').disabled = true;
            controls.style.display = 'flex';
            // ◊ê◊ô◊§◊ï◊° ◊§◊ô◊ì◊ë◊ß ◊ï◊ô◊ñ◊ï◊ê◊ú◊ô
            document.querySelectorAll('.memory-card').forEach(card => {
                card.style.background = '';
                card.classList.remove('selected');
            });
        }

        let selectedCards = new Set();

        function handleCardClick(cardDiv) {
            const fruitKey = cardDiv.dataset.fruitKey;
            if (selectedCards.has(fruitKey)) {
                cardDiv.classList.remove('selected');
                selectedCards.delete(fruitKey);
            } else {
                if (selectedCards.size >= 7) return;
                cardDiv.classList.add('selected');
                selectedCards.add(fruitKey);
            }
            document.getElementById('checkMemoryBtn').disabled = selectedCards.size !== 7;
        }

        function checkMemoryAnswers() {
            // ◊ë◊ì◊ô◊ß◊™ ◊ë◊ó◊ô◊®◊ï◊™
            let correct = 0;
            document.querySelectorAll('.memory-card').forEach(card => {
                const key = card.dataset.fruitKey;
                if (Object.keys(fruits).includes(key)) {
                    if (selectedCards.has(key)) {
                        card.style.background = '#b6ffb6';
                        correct++;
                    } else {
                        card.style.background = '';
                    }
                } else {
                    if (selectedCards.has(key)) {
                        card.style.background = '#ffb6b6';
                    } else {
                        card.style.background = '';
                    }
                }
            });
            setTimeout(() => {
                if (correct === 7) {
                    alert('◊ê◊™◊ù ◊ê◊ú◊ï◊§◊ô◊ù! ◊î◊ô◊î ◊õ◊ô◊ô◊£ ◊ú◊ú◊û◊ï◊ì ◊ê◊ô◊™◊õ◊ù ◊¢◊ú ◊©◊ë◊¢◊™ ◊î◊û◊ô◊†◊ô◊ù ◊™◊ï◊ö ◊õ◊ì◊ô ◊û◊©◊ó◊ß! üåü');
                } else {
                    alert('◊ú◊ê ◊õ◊ú ◊î◊ë◊ó◊ô◊®◊ï◊™ ◊†◊õ◊ï◊†◊ï◊™, ◊†◊°◊ï ◊©◊ï◊ë!');
                }
                // ◊ó◊ñ◊®◊î ◊ú◊û◊°◊ö ◊§◊™◊ô◊ó◊î ◊ë◊ú◊ë◊ì
                currentLevel = 0;
                score = 0;
                lives = 3;
                correctCuts = 0;
                clickedFruits.clear();
                selectedCards.clear();
                gameScreen.classList.add('hidden');
                levelIntroScreen.classList.add('hidden');
                introScreen.classList.remove('hidden');
                updateStartButton();
            }, 1200);
        }

        function gameOver() {
            gameActive = false;
            clearInterval(gameInterval);
            clearInterval(spawnInterval);
            clearInterval(timerInterval);
            
            // ◊î◊°◊™◊®◊™ ◊ò◊ô◊ô◊û◊®
            document.getElementById('timerBox').classList.add('hidden');
            
            // ◊î◊°◊®◊™ ◊°◊û◊ü ◊ó◊®◊ë
            document.body.classList.remove('slicing');
            
            // ◊†◊ô◊ß◊ï◊ô ◊§◊ô◊®◊ï◊™ ◊†◊ï◊§◊ú◊ô◊ù
            fallingFruits.forEach(fruit => fruit.element.remove());
            fallingFruits = [];
            
            alert('◊î◊û◊©◊ó◊ß ◊†◊í◊û◊®! ◊™◊™◊ó◊ô◊ú◊ï ◊û◊ó◊ì◊©');
            
            // ◊ê◊ô◊§◊ï◊° ◊ú◊û◊©◊ó◊ß ◊û◊ó◊ì◊©
            currentLevel = 0;
            score = 0;
            lives = 3;
            correctCuts = 0;
            levelPoints = 0;
            timeLeft = DIFFICULTY[currentDifficulty].timeLimit;
            
            gameScreen.classList.add('hidden');
            showLevelIntro();
        }

        function gameWin() {
            const allSevenSelected = Object.keys(fruits).every(key => selectedCards.has(key));
            if (allSevenSelected) {
                alert('◊ê◊™◊ù ◊ê◊ú◊ï◊§◊ô◊ù! ◊î◊ô◊î ◊õ◊ô◊ô◊£ ◊ú◊ú◊û◊ï◊ì ◊ê◊ô◊™◊õ◊ù ◊¢◊ú ◊©◊ë◊¢◊™ ◊î◊û◊ô◊†◊ô◊ù ◊™◊ï◊ö ◊õ◊ì◊ô ◊û◊©◊ó◊ß! üåü');
            } else {
                alert('◊õ◊ú ◊î◊õ◊ë◊ï◊ì! ◊°◊ô◊ô◊û◊™◊ù ◊ê◊™ ◊õ◊ú ◊î◊©◊ú◊ë◊ô◊ù!\n◊ú◊û◊ì◊™◊ù ◊ê◊™ ◊©◊ë◊¢◊™ ◊î◊û◊ô◊†◊ô◊ù!');
            }
            
            // ◊ê◊ô◊§◊ï◊° ◊ú◊û◊©◊ó◊ß ◊û◊ó◊ì◊©
            currentLevel = 0;
            score = 0;
            lives = 3;
            correctCuts = 0;
            clickedFruits.clear();
            selectedCards.clear();
            
            // ◊ê◊ô◊§◊ï◊° ◊û◊°◊ö ◊î◊§◊™◊ô◊ó◊î
            document.querySelectorAll('.fruit-item').forEach(item => {
                item.classList.remove('clicked', 'selected');
                const checkMark = item.querySelector('.check-mark');
                if (checkMark) {
                    checkMark.remove();
                }
            });
            
            gameScreen.classList.add('hidden');
            levelIntroScreen.classList.add('hidden');
            introScreen.classList.remove('hidden');
            
            updateStartButton();
        }

        // ◊û◊†◊ô◊¢◊™ ◊î◊™◊†◊î◊í◊ï◊™ ◊ë◊®◊ô◊®◊™ ◊û◊ó◊ì◊ú
        document.addEventListener('touchmove', function(e) {
            if (gameActive) e.preventDefault();
        }, { passive: false });
        
        document.addEventListener('touchstart', function(e) {
            if (gameActive) e.preventDefault();
        }, { passive: false });

        // ◊û◊†◊ô◊¢◊™ ◊ñ◊ï◊ù ◊ë◊û◊ï◊ë◊ô◊ô◊ú
        document.addEventListener('gesturestart', function(e) {
            e.preventDefault();
        });

        // ◊î◊™◊ê◊û◊™ ◊í◊ï◊ë◊î ◊ú◊ì◊§◊ì◊§◊†◊ô◊ù ◊û◊ï◊ë◊ô◊ô◊ú
        function setViewportHeight() {
            let vh = window.innerHeight * 0.01;
            document.documentElement.style.setProperty('--vh', `${vh}px`);
        }

        window.addEventListener('resize', setViewportHeight);
        window.addEventListener('orientationchange', setViewportHeight);
        setViewportHeight();

        // ◊§◊ï◊†◊ß◊¶◊ô◊î ◊©◊û◊ó◊ñ◊ô◊®◊î HTML ◊†◊õ◊ï◊ü ◊ú◊§◊®◊ô
        function getFruitHTML(fruitKey, className = 'fruit-emoji') {
            const fruit = fruits[fruitKey];
            if (fruit.emoji.includes('.png')) {
                return `<img src="${fruit.emoji}" class="${className}" alt="${fruit.name}">`;
            } else {
                return `<div class="${className}">${fruit.emoji}</div>`;
            }
        }

        // ◊õ◊§◊™◊ï◊® ◊û◊¢◊ë◊® ◊ú◊©◊ú◊ë ◊î◊ë◊ê
        const nextLevelBtn = document.getElementById('nextLevelBtn');
        nextLevelBtn.addEventListener('click', () => {
            if (correctCuts >= 5) {
                levelComplete();
            }
        });
    </script>
</body>
</html>